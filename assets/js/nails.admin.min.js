var console,NAILS_Admin;void 0===console&&(console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){}});NAILS_Admin=function(){var d=this;return d.__construct=function(){d.initBoxes(),d.initNavSearch(),d.initNavReset(),d.initSearchBoxes(),d.initMobileMenu(),d.initToggles(),d.initWysiwyg(),d.initSelect2(),d.initNiceTime(),d.initSystemAlerts(),$(window).on("resize",function(){d.initMatchHeights()}).trigger("resize")},d.localStorage={enabled:function(){var t,e=(new Date).toString();try{return(t=window.localStorage).setItem(e,e),t.getItem(e)===e,t.removeItem(e),!0}catch(t){return!1}}(),set:function(t,e){return!!this.enabled&&(e=JSON.stringify(e),window.localStorage.setItem(t,e))},get:function(t){if(this.enabled){var e=window.localStorage.getItem(t);return JSON.parse(e)}return!1},remove:function(t){return!!this.enabled&&window.localStorage.removeItem(t)}},d.initBoxes=function(){var t,e,i,o;$(".box .toggle").on("click",function(){return $(this).parents(".box").hasClass("open")?d.closeBox(this,!0):d.openBox(this,!0),d.saveNav(),!1}),$("ul.modules li.module").each(function(){t=$(this).data("initial-state"),e=$(this).find(".toggle"),o=$(this).find(".box-container"),i=o.outerHeight(),e.attr("data-height",i),"open"===t?d.openBox(e,!1):d.closeBox(e,!1)}),$("ul.modules").sortable({axis:"y",placeholder:"sort-placeholder",items:"li.module.sortable",handle:".handle",start:function(t,e){e.placeholder.height(e.helper.outerHeight())},stop:function(){d.saveNav()}})},d.saveNav=function(){var t,e;t={},$("ul.modules li.module").each(function(){e=$(".box",this).hasClass("open"),t[$(this).data("grouping")]={open:e}}),_nails_api.call({controller:"admin/nav",method:"save",action:"POST",data:{preferences:t}})},d.openBox=function(t,e){var i;$(t).parents(".box").attr("id"),$(t).parents(".box").removeClass("closed"),$(t).parents(".box").addClass("open"),i=$(t).attr("data-height"),e?$(t).parents(".box").find(".box-container").stop().animate({height:i}):$(t).parents(".box").find(".box-container").height(i)},d.closeBox=function(t,e){$(t).parents(".box").attr("id"),$(t).parents(".box").removeClass("open"),$(t).parents(".box").addClass("closed"),e?$(t).parents(".box").find(".box-container").stop().animate({height:0}):$(t).parents(".box").find(".box-container").height(0)},d.initNavSearch=function(){$(".nav-search input").on("keyup",function(){var i=$(this).val();i.length?($(".box .toggle").addClass("hidden"),$(".box li").removeClass("hidden").each(function(){var t=new RegExp(i,"gi"),e=$.trim($(this).text());t.test(e)?$(this).removeClass("hidden"):$(this).addClass("hidden")}),$(".box").each(function(){$(this).find("li:not(.hidden)").length?$(this).removeClass("hidden"):$(this).addClass("hidden");var t=$(this).find("ul").outerHeight();$(this).find(".box-container").height(t)})):($(".box").removeClass("hidden"),$(".box li").removeClass("hidden"),$(".box .toggle").removeClass("hidden").each(function(){$(this).closest(".box").hasClass("closed")?d.closeBox(this,!1):d.openBox(this,!1)}))})},d.initNavReset=function(){$("#admin-nav-reset-buttons a").on("click",function(){return"reset"===$(this).data("action")?(_nails_api.call({controller:"admin/nav",method:"reset",action:"POST"}),$("<div>").html("<p>Your navigation has been reset, changes will take hold on the next page load.</p>").dialog({title:"Reset Complete",resizable:!1,draggable:!1,modal:!0,dialogClass:"no-close",buttons:{OK:function(){$(this).dialog("close")},Reload:function(){window.location.reload()}}}).show()):"open"===$(this).data("action")?($("ul.modules li.module").each(function(){var t=$(this).find(".toggle");d.openBox(t,!1)}),d.saveNav()):"close"===$(this).data("action")&&($("ul.modules li.module").each(function(){var t=$(this).find(".toggle");d.closeBox(t,!1)}),d.saveNav()),!1})},d.initSearchBoxes=function(){var e;$("div.search select, div.search input[type=checkbox]").on("change",function(){var t=$(this).closest("form");clearTimeout(e),e=setTimeout(function(){t.submit()},500)}),$("div.search form").on("submit",function(){$(this).closest("div.search").find("div.mask").show()}),$("div.search .filterOption input[type=checkbox]").on("change",function(){$(this).is(":checked")?$(this).closest(".filterOption").addClass("checked"):$(this).closest(".filterOption").removeClass("checked")}),$("div.search .filterOption input[type=checkbox]").each(function(){$(this).is(":checked")?$(this).closest(".filterOption").addClass("checked"):$(this).closest(".filterOption").removeClass("checked")})},d.initMobileMenu=function(){$("#mobileMenuBurger").on("click",function(){var t=$(window).height()-150;return $("#mobileMenu").toggleClass("open"),$("#mobileMenu").hasClass("open")?$("#mobileMenu").css("max-height",t+"px"):$("#mobileMenu").css("max-height","0px"),!1})},d.initToggles=function(){$.fn.toggles?$(".field.boolean:not(.toggled)").each(function(){var t=$(this).find("input[type=checkbox]"),e=$(this).hasClass("readonly"),i=$(this).data("text-on")?$(this).data("text-on"):"ON",o=$(this).data("text-off")?$(this).data("text-off"):"OFF";$(this).find(".toggle").css({width:"100px",height:"30px"}).toggles({checkbox:t,click:!e,drag:!e,clicker:t,on:t.is(":checked"),text:{on:i,off:o}}),$(this).addClass("toggled"),t.hide()}):d.error("NAILS_ADMIN_JS: jQuery Toggles not available.")},d.basicConfig=window.NAILS.URL+"js/ckeditor.config.basic.min.js",d.defaultConfig=window.NAILS.URL+"js/ckeditor.config.default.min.js",d.initWysiwyg=function(){$.fn.ckeditor?_nails_api.call({controller:"admin/ckeditor",method:"configs",action:"GET",success:function(t){d.basicConfig=t.data.basic,d.defaultConfig=t.data.default,d.buildWysiwyg("basic"),d.buildWysiwyg("default")},error:function(){d.error("NAILS_ADMIN_JS: (CKEditor) Falling back to default configuration"),d.buildWysiwyg("basic"),d.buildWysiwyg("default")}}):d.error("NAILS_ADMIN_JS: CKEditor not available.")},d.buildWysiwyg=function(t,e){return"basic"===t?$(".wysiwyg.wysiwyg-basic:not(.wysiwyged)",e).ckeditor({customConfig:d.basicConfig}).addClass("wysiwyged"):"default"===t&&$(".wysiwyg:not(.wysiwyged)",e).ckeditor({customConfig:d.defaultConfig}).addClass("wysiwyged"),d},d.destroyWysiwyg=function(t,e){return"basic"===t?$(".wysiwyg.wysiwyg-basic.wysiwyged",e).ckeditor(function(){this.destroy()}).removeClass("wysiwyged"):"default"===t&&$(".wysiwyg.wysiwyged",e).ckeditor(function(){this.destroy()}).removeClass("wysiwyged"),d},d.initSelect2=function(){$.fn.select2?$("select.select2:not(.select2-offscreen)").select2():this.error("NAILS_JS: Select2 not available.")},d.initNiceTime=function(){$(".nice-time:not(.nice-timed)").each(function(){var t=$(this).text();if(/^\d\d\d\d-\d\d?-\d\d?(\d\d?\:\d\d?\:\d\d?)?$/.test(t)){var e=t.split(" ");if(e[1]||(e[1]="00:00:00"),e[0]){var i=e[0].split("-"),o=e[1].split(":"),n=i[0],a=i[1],s=i[2],c=o[0],r=o[1],l=o[2],d=new Date(n,a,s,c,r,l);isNaN(d.getTime())||($(this).addClass("nice-timed"),$(this).attr("data-time",t),$(this).attr("data-year",n),$(this).attr("data-month",a),$(this).attr("data-day",s),$(this).attr("data-hour",c),$(this).attr("data-minute",r),$(this).attr("data-second",l),$(this).attr("title",t))}}}),$(".nice-timed").each(function(){var t=$(this).attr("data-year"),e=$(this).attr("data-month")-1,i=$(this).attr("data-day"),o=$(this).attr("data-hour"),n=$(this).attr("data-minute"),a=$(this).attr("data-second"),s=new Date(t,e,i,o,n,a),c=new Date,r="",l=Math.ceil((c.getTime()-s.getTime())/1e3);0<=l&&l<10?r="a moment ago":10<=l?r=d.initNiceTimeCalc(l)+" ago":l<0&&(r=d.initNiceTimeCalc(l)+" from now"),"1 day ago"===r?r="yesterday":"1 day from now"===r&&(r="tomorrow"),!0===$(this).data("capitalise")&&(r=r.charAt(0).toUpperCase()+r.slice(1)),$(this).text(r)})},d.initNiceTimeCalc=function(t){var e=0,i="",o=86400;return t<0&&(t*=-1),i=t<60?(e=t,"second"):t<3600?(e=Math.floor(t/60),"minute"):t<o?(e=Math.floor(t/60/60),"hour"):t<604800?(e=Math.floor(t/60/60/24),"day"):t<2592e3?(e=Math.floor(t/60/60/24/7),"week"):t<31536e3?(e=Math.floor(t/60/60/24/30),"month"):(e=Math.floor(t/60/60/24/365),"year"),e+" "+i+(1===e?"":"s")},d.initSystemAlerts=function(){$(".alert__close").on("click",function(){$(this).closest(".alert").remove()})},d.error=function(t){window.console&&"PRODUCTION"!==window.ENVIRONMENT&&console.error(t)},d.numberFormat=function(t,e,i,o){t=(t+"").replace(/[^0-9+\-Ee.]/g,"");var n,a,s,c=isFinite(+t)?+t:0,r=isFinite(+e)?Math.abs(e):0,l=void 0===o?",":o,d=void 0===i?".":i,h="";return 3<(h=(r?(n=c,a=r,s=Math.pow(10,a),""+(Math.round(n*s)/s).toFixed(a)):""+Math.round(c)).split("."))[0].length&&(h[0]=h[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,l)),(h[1]||"").length<r&&(h[1]=h[1]||"",h[1]+=new Array(r-h[1].length+1).join("0")),h.join(d)},d.initMatchHeights=function(){var t,e,i;t={},(e=$(".match-height")).each(function(){$(this).height(""),i=$(this).data("height-group")||"default",void 0===t[i]&&(t[i]=0),$(this).height()>t[i]&&(t[i]=$(this).height())}),e.each(function(){i=$(this).data("height-group")||"default",$(this).height(t[i])})},d.__construct()};
//# sourceMappingURL=nails.admin.min.js.map
