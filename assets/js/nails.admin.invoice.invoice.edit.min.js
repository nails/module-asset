var invoiceEdit=function(t,e,o){var n,a;n=this,n.units=ko.observableArray();for(a in t)t.hasOwnProperty(a)&&n.units.push({slug:a,label:t[a]});n.taxes=ko.observableArray([{id:"",label:"No Tax - 0%"}]);for(a in e)e.hasOwnProperty(a)&&n.taxes.push({id:e[a].id,rate:e[a].rate,label:e[a].label+" - "+e[a].rate+"%"});n.items=ko.observableArray();for(a in o)o.hasOwnProperty(a)&&(o[a].quantity=ko.observable(o[a].quantity),o[a].unit_cost=ko.observable(o[a].unit_cost),o[a].tax_id=ko.observable(o[a].tax_id),n.items.push(o[a]));n.state=ko.observable(""),n.dated=ko.observable(""),n.terms=ko.observable(""),n.addItem=function(){var t={id:null,quantity:ko.observable(1),unit:null,label:"",body:"",unit_cost:ko.observable(null),tax_id:ko.observable(null)};n.items.push(t)},n.removeItem=function(){n.items.remove(this)},n.moveUp=function(){var t=n.items.indexOf(this);if(t>=1){var e=n.items();n.items.splice(t-1,2,e[t],e[t-1])}},n.moveDown=function(){var t=n.items().indexOf(this);if(t<n.items().length-1){var e=n.items();n.items.splice(t,2,e[t+1],e[t])}},n.submitText=ko.computed(function(){if("DRAFT"===n.state())return"Save Draft";var t=moment(n.dated(),"YYYY-MM-DD");return t.isAfter()?"Schedule to Send":"Send Now"}),n.submitClass=ko.computed(function(){if("DRAFT"===n.state())return"btn btn-primary";var t=moment(n.dated(),"YYYY-MM-DD");return t.isAfter()?"btn btn-warning":"btn btn-success"}),n.stateChanged=function(){n.state($("#invoice-state").val())},n.dateChanged=function(){n.dated($("#invoice-dated").val())},n.termsChanged=function(){n.terms(parseInt($("#invoice-terms").val(),10))},n.termsText=function(){var t;if(n.terms()){var e=moment(n.dated(),"YYYY-MM-DD");e.add(n.terms(),"d"),t=e.format("MMM Do, YYYY")}else t="receipt";return"Invoice will be due on <strong>"+t+"</strong>"},n.calculateSubTotal=ko.computed(function(){for(var t=0,e=n.items().length-1;e>=0;e--)t+=n.items()[e].quantity()*n.items()[e].unit_cost();return t}),n.calculateTax=ko.computed(function(){for(var t=0,e=n.items().length-1;e>=0;e--)if(n.items()[e].tax_id())for(var o=n.taxes().length-1;o>=0;o--)n.taxes()[o].id===n.items()[e].tax_id()&&(t+=n.items()[e].quantity()*n.items()[e].unit_cost()*(n.taxes()[o].rate/100));return t}),n.calculateGrandTotal=ko.computed(function(){var t=0;return t+=n.calculateSubTotal(),t+=n.calculateTax()}),n.log=function(t,e){"function"==typeof console.log&&(void 0!==e?console.log("Invoice Edit:",t,e):console.log("Invoice Edit:",t))},n.warn=function(t,e){"function"==typeof console.warn&&(void 0!==e?console.warn("Invoire Edit:",t,e):console.warn("Invoire Edit:",t))}};
//# sourceMappingURL=nails.admin.invoice.invoice.edit.min.js.map
