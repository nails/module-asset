var NAILS_Forms;NAILS_Forms=function(){var i=this;return i.__construct=function(){i.initWidgetEditors(),i.initMultiFiles()},i.widgetEditor=null,i.activeArea=null,i.initWidgetEditors=function(){"function"==typeof NAILS_Admin_CMS_WidgetEditor?(i.widgetEditor=new NAILS_Admin_CMS_WidgetEditor,$(".field.cms-widgets .open-editor").each(function(){var t=$(this).data("key"),e=$(this).siblings("input.widget-data");if(e.length)try{var n=JSON.parse(e.val());i.widgetEditor.setAreaData(t,n)}catch(a){}}),$(document).on("click",".field.cms-widgets .open-editor",function(){return i.activeArea=$(this),i.log("Opening Editor for area: "+i.activeArea.data("key")),i.widgetEditor.show(i.activeArea.data("key")),!1}),$(i.widgetEditor).on("widgeteditor-close",function(){i.log("Editor Closing, getting area data and saving to input");var t=i.widgetEditor.getAreaData(i.activeArea.data("key")),e=i.activeArea.siblings("input.widget-data");e.length&&e.val(JSON.stringify(t)),i.activeArea=null})):$(".field.cms-widgets .open-editor").addClass("disabled").after('<p class="alert alert-warning">Module nailsapp/module-cms is not available</p>')},i.initMultiFiles=function(){$(document).on("click",".js-cdn-multi-action-add",function(){i.log("MultiFile: Adding Row");var t=$(this).closest(".field"),e=t.data("items")||[],n={id:null,object_id:null,label:null};return e.push(n),t.data("items",e),i.renderMultFiles(t,e),!1}),$(document).on("click",".js-cdn-multi-action-remove",function(){i.log("MultiFile: Removing Row");for(var t=$(this).data("index"),e=$(this).closest(".field"),n=e.data("items")||[],a=[],d=0;d<n.length;d++)d!==t&&a.push(n[d]);return i.renderMultFiles(e,a),e.data("items",a),!1}),$(".field.cdn-multi").each(function(){var t=$(this).data("defaults");$(this).data("items",t),$(this).find(".cdn-object-picker").on("picked",function(){i.multiCdnPicked($(this))}),$(this).find(".js-label").on("keyup",function(){i.multiLabelChanged($(this))})})},i.renderMultFiles=function(t,e){i.log("MultiFile: Rendering",e);var n=t.find(".js-row-target"),a=t.children(".js-row-tpl").html(),d="";n.empty();for(var o=0;o<e.length;o++)e[o].index=o,d=Mustache.render(a,e[o]),d=$(d),d.find(".cdn-object-picker").on("picked",function(){i.multiCdnPicked($(this))}),d.find(".js-label").on("keyup",function(){i.multiLabelChanged($(this))}),n.append(d);_CDN_OBJECTPICKER.initPickers()},i.multiCdnPicked=function(t){for(var e=t.data("index"),n=t.closest(".field"),a=n.data("items")||[],d=0;d<a.length;d++)if(d===e){i.log("Updating object ID to "+t.find(".cdn-object-picker__input").val()),i.log("At index: "+e),a[d].object_id=parseInt(t.find(".cdn-object-picker__input").val(),10)||null;break}n.data("items",a)},i.multiLabelChanged=function(t){for(var e=t.data("index"),n=t.closest(".field"),a=n.data("items")||[],d=0;d<a.length;d++)if(d===e){i.log("Updating label"),a[d].label=t.val();break}n.data("items",a)},i.log=function(i,t){"function"==typeof console.log&&(void 0!==t?console.log("Nails Forms:",i,t):console.log("Nails Forms:",i))},i.warn=function(i,t){"function"==typeof console.warn&&(void 0!==t?console.warn("Nails Forms:",i,t):console.warn("Nails Forms:",i))},i.__construct()};
//# sourceMappingURL=nails.forms.min.js.map
