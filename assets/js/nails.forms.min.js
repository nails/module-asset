var NAILS_Forms;NAILS_Forms=function(){var o=this;return o.__construct=function(){o.initMultiFiles(),o.initCharCounters()},o.initMultiFiles=function(){$(document).on("click",".js-cdn-multi-action-add",function(){o.log("MultiFile: Adding Row");var t=$(this).closest(".field"),i=t.data("items")||[],n={id:null,object_id:null};return n[t.data("label-key")]=null,i.push(n),t.data("items",i),o.renderMultFiles(t,i),!1}),$(document).on("click",".js-cdn-multi-action-remove",function(){o.log("MultiFile: Removing Row");for(var t=$(this).data("index"),i=$(this).closest(".field"),n=i.data("items")||[],e=[],l=0;l<n.length;l++)l!==t&&e.push(n[l]);return o.renderMultFiles(i,e),i.data("items",e),!1}),$(".field.cdn-multi").each(function(){var t=$(this).data("defaults"),i=$(this).data("label-key");$(this).data("items",t).data("label-key",i),$(this).find(".cdn-object-picker").on("picked",function(){o.multiCdnPicked($(this))}),$(this).find(".js-label").on("keyup",function(){o.multiLabelChanged($(this))})})},o.renderMultFiles=function(t,i){o.log("MultiFile: Rendering",i);var n=t.find(".js-row-target"),e=t.children(".js-row-tpl").html(),l="";n.empty();for(var a=0;a<i.length;a++)i[a].index=a,l=Mustache.render(e,i[a]),(l=$(l)).find(".cdn-object-picker").on("picked",function(){o.multiCdnPicked($(this))}),l.find(".js-label").on("keyup",function(){o.multiLabelChanged($(this))}),n.append(l);window.NAILS.ADMIN.getInstance("ObjectPicker","nails/module-cdn").initPickers()},o.multiCdnPicked=function(t){for(var i=t.data("index"),n=t.closest(".field"),e=n.data("items")||[],l=0;l<e.length;l++)if(l===i){o.log("Updating object ID to "+t.find(".cdn-object-picker__input").val()),o.log("At index: "+i),e[l].object_id=parseInt(t.find(".cdn-object-picker__input").val(),10)||null;break}n.data("items",e)},o.multiLabelChanged=function(t){for(var i=t.data("index"),n=t.closest(".field"),e=n.data("items")||[],l=0;l<e.length;l++)if(l===i){o.log("Updating label"),e[l][n.data("label-key")]=t.val();break}n.data("items",e)},o.initCharCounters=function(){$(".field .char-count:not(.counting)").each(function(){var i=$(this),n=i.data("max-length"),e=$(this).closest(".field"),t=$(this).closest(".input").find(".field-input");t.length&&t.on("keyup",function(){var t=$(this).val().length;n<t?e.addClass("max-length-exceeded"):e.removeClass("max-length-exceeded"),i.html(t+" of "+n+" characters")}).trigger("keyup"),i.addClass("counting")})},o.log=function(t,i){"function"==typeof console.log&&(void 0!==i?console.log("Nails Forms:",t,i):console.log("Nails Forms:",t))},o.warn=function(t,i){"function"==typeof console.warn&&(void 0!==i?console.warn("Nails Forms:",t,i):console.warn("Nails Forms:",t))},o.__construct()};
//# sourceMappingURL=nails.forms.min.js.map
