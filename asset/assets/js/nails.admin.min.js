if("undefined"==typeof console){var console;console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){}}}var NAILS_Admin;NAILS_Admin=function(){this.errorDelay=6e3,this.init=function(){this.init_boxes(),this.init_navsearch(),this.init_nav_reset(),this.init_search_boxes(),this.init_mobile_menu(),this.init_toggles(),this.init_ckeditor(),this.init_select2(),this.init_nicetime()},this.init_boxes=function(){var t=this;$(".box .toggle").on("click",function(){return $(this).parents(".box").hasClass("open")?t._close_box(this,!0):t._open_box(this,!0),t._save_nav(),!1});var e,i,o,n;$("ul.modules li.module").each(function(){e=$(this).data("initial-state"),i=$(this).find(".toggle"),n=$(this).find(".box-container"),o=n.outerHeight(),i.attr("data-height",o),"open"===e?t._open_box(i,!1):t._close_box(i,!1)}),$("ul.modules").sortable({axis:"y",placeholder:"sort-placeholder",items:"li.module:not(.no-sort)",handle:".handle",start:function(t,e){e.placeholder.height(e.helper.outerHeight())},stop:function(){t._save_nav()}})},this._save_nav=function(){var t,e,i;t={},$("ul.modules li.module").each(function(){i=$(".box",this).hasClass("open"),t[$(this).data("module")]={open:i}}),e={controller:"admin",method:"nav/save",action:"GET",data:{preferences:t}},_nails_api.call(e)},this._open_box=function(t,e){var i,o;i=$(t).parents(".box").attr("id"),$(t).parents(".box").removeClass("closed"),$(t).parents(".box").addClass("open"),o=$(t).attr("data-height"),e?$(t).parents(".box").find(".box-container").stop().animate({height:o}):$(t).parents(".box").find(".box-container").height(o)},this._close_box=function(t,e){var i;i=$(t).parents(".box").attr("id"),$(t).parents(".box").removeClass("open"),$(t).parents(".box").addClass("closed"),e?$(t).parents(".box").find(".box-container").stop().animate({height:0}):$(t).parents(".box").find(".box-container").height(0)},this._save=function(t,e){if("undefined"==typeof localStorage)this._show_error(window.NAILS.LANG.non_html5);else try{localStorage.setItem(t,e)}catch(i){this._show_error(window.NAILS.LANG.no_save)}},this._get=function(t){if("undefined"==typeof localStorage)this._show_error(window.NAILS.LANG.non_html5);else try{return localStorage.getItem(t)}catch(e){this._show_error(window.NAILS_LANG.no_save)}},this.init_navsearch=function(){var t=this;$(".nav-search input").on("keyup",function(){var e=$(this).val();e.length?($(".box .toggle").hide(),$(".box li").each(function(){var t=new RegExp(e,"gi");t.test($(this).text())?$(this).show():$(this).hide();var i=$(this).parents(".box").find("ul").outerHeight();$(this).parents(".box").find(".box-container").height(i),$(this).parents(".box").stop().css($(this).parents(".box").find("li:visible").length?{opacity:1}:{opacity:.25})})):($(".box").stop().animate({opacity:1},"fast"),$(".box li").each(function(){$(this).show()}),$(".box .toggle").each(function(){$(this).show();var e=$(this).closest(".box").hasClass("closed");e?t._open_box(this,!1):t._close_box(this,!1)}))})},this.init_nav_reset=function(){$("#admin-nav-reset").on("click",function(){var t={controller:"admin",method:"nav/reset",action:"POST"};_nails_api.call(t),$("<div>").html("<p>Your navigation has been reset, changes will take hold on the next page load.</p>").dialog({title:"Reset Complete",resizable:!1,draggable:!1,modal:!0,dialogClass:"no-close",buttons:{OK:function(){$(this).dialog("close")}}}).show()})},this.init_search_boxes=function(){$("div.search select, div.search input[type=checkbox]").on("change",function(){$(this).closest("form").find("input[type=submit]").click()}),$("div.search form").on("submit",function(){$(this).closest("div.search").find("div.mask").show()})},this.init_mobile_menu=function(){$("#mobile-menu-main").on("change",function(){var t=$(this).find("option:selected").val();t.length&&(window.location.href=window.SITE_URL+t)})},this._fieldset_toggle=function(t){var e=t.closest("fieldset");e.hasClass("closed")?(e.removeClass("closed"),e.attr("id")&&this._save("fieldset-"+e.attr("id"),"open")):(e.addClass("closed"),e.attr("id")&&this._save("fieldset-"+e.attr("id"),"closed"))},this.init_toggles=function(){$.fn.toggles?$(".field.boolean:not(.toggled)").each(function(){var t=$(this).find("input[type=checkbox]"),e=$(this).hasClass("readonly"),i=$(this).data("text-on")?$(this).data("text-on"):"ON",o=$(this).data("text-off")?$(this).data("text-off"):"OFF";$(this).find(".toggle").css({width:"100px",height:"30px"}).toggles({checkbox:t,click:!e,drag:!e,clicker:t,on:t.is(":checked"),text:{on:i,off:o}}),$(this).addClass("toggled"),t.hide()}):this.error("NAILS_ADMIN_JS: jQuery Toggles not available.")},this.init_ckeditor=function(){$.fn.ckeditor?($(".wysiwyg.wysiwyg-basic").ckeditor({customConfig:window.NAILS.URL+"js/ckeditor.config.basic.min.js"}),$(".wysiwyg:not(.wysiwyg-basic)").ckeditor({customConfig:window.NAILS.URL+"js/ckeditor.config.default.min.js"})):this.error("NAILS_ADMIN_JS: CKEditor not available.")},this.init_select2=function(){$.fn.select2?$("select.select2:not(.select2-offscreen)").select2():this.error("NAILS_JS: Select2 not available.")},this.init_nicetime=function(){var t=this,e=$(".nice-time:not(.nice-timed)");e.each(function(){var t=$(this).text(),e=/^\d\d\d\d-\d\d?-\d\d?( \d\d?\:\d\d?\:\d\d?)?$/;if(e.test(t)){var i=t.split(" ");if(i[1]||(i[1]="00:00:00"),i[0]){var o=i[0].split("-"),n=i[1].split(":"),s=o[0],a=o[1],r=o[2],h=n[0],c=n[1],l=n[2],d=new Date(s,a,r,h,c,l);isNaN(d.getTime())||($(this).addClass("nice-timed"),$(this).attr("data-time",t),$(this).attr("data-year",s),$(this).attr("data-month",a),$(this).attr("data-day",r),$(this).attr("data-hour",h),$(this).attr("data-minute",c),$(this).attr("data-second",l),$(this).attr("title",t))}}}),$(".nice-timed").each(function(){var e=$(this).attr("data-year"),i=$(this).attr("data-month")-1,o=$(this).attr("data-day"),n=$(this).attr("data-hour"),s=$(this).attr("data-minute"),a=$(this).attr("data-second"),r=new Date(e,i,o,n,s,a),h=new Date,c="",l=Math.ceil((h.getTime()-r.getTime())/1e3);console.log(l),l>=0&&10>l?c="a moment ago":l>=10?c=t._nice_time_calc(l)+" ago":0>l&&(c=t._nice_time_calc(l)+" from now"),"1 day ago"===c?c="yesterday":"1 day from now"===c&&(c="tomorrow"),$(this).data("capitalise")===!0&&(c=c.charAt(0).toUpperCase()+c.slice(1)),$(this).text(c)})},this._nice_time_calc=function(t){var e=0,i="",o=1,n=60*o,s=60*n,a=24*s,r=7*a,h=30*a,c=365*a;0>t&&(t=-1*t),n>t?(e=t,i="second"):s>t?(e=Math.floor(t/60),i="minute"):a>t?(e=Math.floor(t/60/60),i="hour"):r>t?(e=Math.floor(t/60/60/24),i="day"):h>t?(e=Math.floor(t/60/60/24/7),i="week"):c>t?(e=Math.floor(t/60/60/24/30),i="month"):(e=Math.floor(t/60/60/24/365),i="year");var l=1===e?"":"s";return e+" "+i+l},this._show_error=function(t){return $(".js_error span.message").text(t),$(".js_error").slideDown().delay(this.errorDelay).slideUp(),!0},this.error=function(t){window.console&&"PRODUCTION"!==window.ENVIRONMENT&&console.error(t)}};
//# sourceMappingURL=./nails.admin.min.js.map