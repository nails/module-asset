if("undefined"==typeof console){var console;console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){}}}var NAILS_JS;NAILS_JS=function(){this.init=function(){this._init_system_alerts(),this._init_tipsy(),this._init_fancybox(),this._init_confirm(),this._init_nicetime(),this._init_tabs(),this._init_forms()},this._init_system_alerts=function(){if($.fn.scrollTo){var t=$("div.field.error:visible"),i;if(t.length)i=$(t.get(0));else{var a=$("div.system-alert.error:visible");i=$(a.get(0))}i.length&&setTimeout(function(){$.scrollTo(i,"fast",{axis:"y",offset:{top:-25}})},750)}else this.log("NAILS_JS: scrollTo not available.")},this._init_tipsy=function(){$.fn.tipsy?($("*[rel=tipsy]:not(.drunk)").tipsy({opacity:.85}).addClass("drunk"),$("*[rel=tipsy-html]:not(.drunk)").tipsy({opacity:.85,html:!0}).addClass("drunk"),$("*[rel=tipsy-right]:not(.drunk)").tipsy({opacity:.85,gravity:"w"}).addClass("drunk"),$("*[rel=tipsy-left]:not(.drunk)").tipsy({opacity:.85,gravity:"e"}).addClass("drunk"),$("*[rel=tipsy-top]:not(.drunk)").tipsy({opacity:.85,gravity:"s"}).addClass("drunk"),$("*[rel=tipsy-bottom]:not(.drunk)").tipsy({opacity:.85,gravity:"n"}).addClass("drunk")):this.log("NAILS_JS: Tipsy not available.")},this._init_fancybox=function(){$.fn.fancybox?$(document).on("click",".fancybox",function(){var t=$(this).attr("href");if("#"!==t.substr(0,1)){var i=/\?/g;t+=i.test(t)?"&":"?",t+="is_fancybox=true"}var a=$(this).data("height"),e=$(this).data("width");return $(this).fancybox({href:t,width:e,height:a}),$(this).hasClass("fancyboxed")||($(this).addClass("fancyboxed"),$(this).trigger("click")),!1}):this.log("NAILS_JS: Fancybox not available.")},this._init_confirm=function(){$(document).on("click","a.confirm",function(){var t=$(this),i=t.data("body").replace(/\\n/g,"\n"),a=t.data("title");return i.length?($("<div>").html(i).dialog({title:a,resizable:!1,draggable:!1,modal:!0,dialogClass:"no-close",buttons:{OK:function(){window.location.href=t.attr("href")},Cancel:function(){$(this).dialog("close")}}}),!1):!0})},this._init_nicetime=function(){var t=this,i=$(".nice-time:not(.nice-timed)");i.each(function(){var t=$(this).text(),i=/^\d\d\d\d-\d\d?-\d\d?( \d\d?\:\d\d?\:\d\d?)?$/;if(i.test(t)){var a=t.split(" ");if(a[1]||(a[1]="00:00:00"),a[0]){var e=a[0].split("-"),s=a[1].split(":"),n=e[0],o=e[1],d=e[2],r=s[0],c=s[1],l=s[2],h=new Date(n,o,d,r,c,l);isNaN(h.getTime())||($(this).addClass("nice-timed"),$(this).attr("data-time",t),$(this).attr("data-year",n),$(this).attr("data-month",o),$(this).attr("data-day",d),$(this).attr("data-hour",r),$(this).attr("data-minute",c),$(this).attr("data-second",l),$(this).attr("title",t))}}}),$(".nice-timed").each(function(){var i=$(this).attr("data-year"),a=$(this).attr("data-month")-1,e=$(this).attr("data-day"),s=$(this).attr("data-hour"),n=$(this).attr("data-minute"),o=$(this).attr("data-second"),d=new Date(i,a,e,s,n,o),r=new Date,c="",l=Math.ceil((r.getTime()-d.getTime())/1e3);l>=0&&10>l?c="just now":l>=10?c=t._nice_time_calc(l)+" ago":0>l&&(c=t._nice_time_calc(l)+" from now"),$(this).text(c)})},this._nice_time_calc=function(t){var i=0,a="",e=1,s=60*e,n=60*s,o=24*n,d=7*o,r=30*o,c=365*o;0>t&&(t=-1*t),s>t?(i=t,a="second"):n>t?(i=Math.floor(t/60),a="minute"):o>t?(i=Math.floor(t/60/60),a="hour"):d>t?(i=Math.floor(t/60/60/24),a="day"):r>t?(i=Math.floor(t/60/60/24/7),a="week"):c>t?(i=Math.floor(t/60/60/24/30),a="month"):(i=Math.floor(t/60/60/24/365),a="year");var l=1===i?"":"s";return i+" "+a+l},this._init_tabs=function(){var t=this;$(document).on("click","ul.tabs:not(.disabled) li.tab a",function(){return $(this).hasClass("disabled")||t.switch_to_tab($(this)),!1}),$("li.tab a").each(function(){$("#"+$(this).data("tab")+" div.field.error").length&&$(this).addClass("error"),$("#"+$(this).data("tab")+" .system-alert.error").length&&$(this).addClass("error"),$("#"+$(this).data("tab")+" .error.show-in-tabs").length&&$(this).addClass("error")})},this.switch_to_tab=function(t){var i=t.parents("ul.tabs"),a=t.parents("ul.tabs").data("tabgroup");a=a?"."+a:"",$("li.tab",i).removeClass("active"),t.parent().addClass("active");var e=t.attr("data-tab");$("section.tabs"+a+" > div.tab.page").removeClass("active"),$("#"+e).addClass("active"),this.add_stripes()},this._init_forms=function(){this.add_stripes(),this.process_prefixed_inputs(),$.fn.datepicker?$("div.field.date input.date").each(function(){var t=$(this).data("datepicker-dateformat")||"yy-mm-dd",i=$(this).data("datepicker-yearrange")||"c-100:c+10";$(this).datepicker({dateFormat:t,changeMonth:!0,changeYear:!0,yearRange:i}).prop("readonly",!0)}):this.error("NAILS_JS: datepicker not available."),$.fn.datetimepicker?$("div.field.datetime input.datetime").each(function(){var t=$(this).data("datepicker-dateformat")||"yy-mm-dd",i=$(this).data("datepicker-timeformat")||"HH:mm:ss",a=$(this).data("datepicker-yearrange")||"c-100:c+10";$(this).datetimepicker({dateFormat:t,timeFormat:i,changeMonth:!0,changeYear:!0,yearRange:a}).prop("readonly",!0)}):this.log("NAILS_JS: datetimepicker not available.")},this.add_stripes=function(){$("fieldset,.fieldset").each(function(){$("div.field",this).removeClass("odd even"),$("div.field:visible:odd",this).addClass("odd"),$("div.field:visible:even",this).addClass("even")})},this.process_prefixed_inputs=function(){$("input[data-prefix]:not(.nails-prefixed)").each(function(){var t=$("<div>").addClass("nails-prefixed").css("width",$(this).css("width")),i=$("<div>").addClass("nails-prefix").html($(this).data("prefix"));t.append(i),$(this).clone(!0).addClass("nails-prefixed").appendTo(t),$(this).replaceWith(t)})},this.log=function(t){window.console&&"production"!==window.ENVIRONMENT&&console.log(t)},this.error=function(t){window.console&&"production"!==window.ENVIRONMENT&&console.error(t)},this.warn=function(t){window.console&&"production"!==window.ENVIRONMENT&&console.warn(t)}};